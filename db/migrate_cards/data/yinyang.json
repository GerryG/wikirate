{
  "url": null,
  "timestamp": "2015-03-14 16:22:19 +0100",
  "card": {
    "name": "export",
    "type": "Pointer",
    "content": "[[yinyang]]\n[[Company+metric sidebar+*type plus right+*structure]]\n[[Company+topic sidebar+*type plus right+*structure]]\n[[metric drag item]]\n[[topic drag item]]\n[[metric details+*right+*structure]]\n[[topic details+*right+*structure]]\n[[latest value+*right+*structure]]\n[[*unsaved list]]\n[[*empty list]]\n[[*upvotes+*empty list]]\n[[*downvotes+*empty list]]\n[[*upvoted+*right+*structure]]\n[[*downvoted+*right+*structure]]\n[[*neutral+*right+*structure]]\n[[votee search+*right+*structure]]\n[[non-votee search+*right+*structure]]\n[[votee filter]]\n[[Topic+Company+*ltype rtype+*structure]]\n[[rating css and js]]\n[[needs polish]]\n[[style: rating]]\n[[script: rating]]\n[[latest value]]\n[[votee search]]\n[[non-votee search]]",
    "value": [
      {
        "name": "yinyang",
        "type": "HTML",
        "content": "<div class=\"wiki\">\r\n  <div class=\"yinyang\">\r\n    Wiki\r\n  </div>\r\n  <h4>\r\n    Topics important to me\r\n  </h4>\r\n  {{_left+topic sidebar}}\r\n</div>\r\n<div class=\"rate\">\r\n  <div class=\"yinyang\">\r\n    Rate\r\n  </div>\r\n  <h4>\r\n    Metrics important to me\r\n  </h4>\r\n  {{_left+metric sidebar}}\r\n</div>\r\n{{rating css and js|raw}}"
      },
      {
        "name": "Company+metric sidebar+*type plus right+*structure",
        "type": "HTML",
        "content": "  <div class=\"voting\">\r\n  {{_left+metric+*upvotes+votee search|drag_and_drop_list|structure:metric drag item}}\r\n  {{votee filter|raw}}\r\n  {{_left+metric+non-votee search|drag_and_drop_list|structure:metric drag item}} \r\n  {{_left+metric+*downvotes+votee search|drag_and_drop_list|structure:metric drag item}}\r\n  </div>"
      },
      {
        "name": "Company+topic sidebar+*type plus right+*structure",
        "type": "HTML",
        "content": "<div class=\"voting\">\r\n{{_left+topic+*upvotes+votee search|drag_and_drop_list|structure:topic drag item}}\r\n{{votee filter}}\r\n{{_left+topic+non-votee search|drag_and_drop_list|structure:topic drag item}} \r\n{{_left+topic+*downvotes+votee search|drag_and_drop_list|structure:topic drag item}}\r\n</div>"
      },
      {
        "name": "metric drag item",
        "type": "HTML",
        "content": "  <div class=\"metric-item\">\r\n    <div class=\"header\">\r\n      <div class=\"handle\">\r\n        <span class=\"glyphicon glyphicon-option-vertical left\"></span>\r\n        <span class=\"glyphicon glyphicon-option-vertical right\"></span>\r\n      </div>\r\n      {{_l+*vote count}}\r\n      <div class=\"title\">\r\n        {{_ll+logo|core;size:icon}} \r\n        <span class=\"name\">{{_lr|name}}</span>\r\n      </div>\r\n    </div>\r\n    <div class=\"data\">\r\n      {{_self+latest value|concise}} \r\n      <span class=\"details-toggle\" data-append=\"metric_details\">\r\n      <span class=\"glyphicon glyphicon-triangle-right\"></span>\r\n      </span>\r\n    </div>\r\n    <div class=\"details\">\r\n    </div>\r\n  </div>"
      },
      {
        "name": "topic drag item",
        "type": "HTML",
        "content": "  <div class=\"topic-item\">\r\n    <div class=\"header\">\r\n      <div class=\"handle\">\r\n        <span class=\"glyphicon glyphicon-option-vertical left\"></span>\r\n        <span class=\"glyphicon glyphicon-option-vertical right\"></span>\r\n      </div>\r\n      {{_l+*vote count}}\r\n      <div class=\"title\">\r\n        {{_l+image|core;size:icon}} \r\n        <span class=\"name\">{{_l|name}}</span>\r\n      </div>\r\n    </div>\r\n    <div class=\"data\">\r\n      <span class=\"details-toggle\" data-append=\"topic_details\">\r\n      <span class=\"glyphicon glyphicon-triangle-right\"></span>\r\n      </span>\r\n    </div>\r\n    <div class=\"details\">\r\n    </div>\r\n  </div>"
      },
      {
        "name": "metric details+*right+*structure",
        "type": "HTML",
        "content": "{{_ll+methodology}}"
      },
      {
        "name": "topic details+*right+*structure",
        "type": "HTML",
        "content": "{{_2+_1+article}}"
      },
      {
        "name": "latest value+*right+*structure",
        "type": "Search",
        "content": "{\"left\":\"_self\",\"right\":{\"type\":\"year\"},\"dir\":\"desc\",\"limit\":\"1\"}"
      },
      {
        "name": "*unsaved list",
        "type": "Basic",
        "content": "<p>You have to {{*account links|sign_in}} or {{*account links|sign_up}} to save your changes.</p>"
      },
      {
        "name": "*empty list",
        "type": "Basic",
        "content": "",
        "codename": "empty_list"
      },
      {
        "name": "*upvotes+*empty list",
        "type": "HTML",
        "content": "Drag and drop here to Vote UP"
      },
      {
        "name": "*downvotes+*empty list",
        "type": "Basic",
        "content": "<p><span>Drag and drop here toÂ </span><strong>Vote DOWN</strong></p>"
      },
      {
        "name": "*upvoted+*right+*structure",
        "type": "Search",
        "content": "{\"type\":\"_\",\"linked_to_by\":{\"left\":\"_user\",\"right\":\"*upvotes\"}}"
      },
      {
        "name": "*downvoted+*right+*structure",
        "type": "Search",
        "content": "{\"type\":\"_\",\"linked_to_by\":{\"left\":\"_user\",\"right\":\"*downvotes\"}}"
      },
      {
        "name": "*neutral+*right+*structure",
        "type": "Search",
        "content": "{\"type\":\"_\",\"not\":{\"linked_to_by\":{\"left\":\"_user\",\"right\":[\"in\",\"*upvotes\",\"*downvvotes\"]}}}"
      },
      {
        "name": "votee search+*right+*structure",
        "type": "Search",
        "content": "{\"type\":\"_2\",\"linked_to_by\":{\"left\":\"_user\",\"right\":\"_3\"},\"append\":\"_1\"}"
      },
      {
        "name": "non-votee search+*right+*structure",
        "type": "Search",
        "content": "{\"type\":\"_2\",\"not\":{\"linked_to_by\":{\"left\":\"_user\",\"right\":[\"in\",\"*upvotes\",\"*downvotes\"]}},\"append\":\"_1\"}"
      },
      {
        "name": "votee filter",
        "type": "HTML",
        "content": "<div class=\"votee-filter\">\r\n<span class=\"glyphicon glyphicon-filter\"></span>\r\nfilter\r\n<span class=\"filter-toggle\">\r\n<span class=\"glyphicon glyphicon-triangle-right\"></span>\r\n</span>\r\n<div class=\"filter-details\">\r\n<button class=\"btn btn-primary importance\">importance</button>\r\n<button class=\"btn btn-primary recent\">recent</button>\r\n</div>\r\n</div>"
      },
      {
        "name": "Topic+Company+*ltype rtype+*structure",
        "type": "Basic",
        "content": ""
      },
      {
        "name": "rating css and js",
        "type": "Basic",
        "content": "",
        "codename": "drag_and_drop_css_and_js"
      },
      {
        "name": "needs polish",
        "type": "Pointer",
        "content": "[[yinyang]]\n[[Company+metric sidebar+*type plus right+*structure]]\n[[Company+topic sidebar+*type plus right+*structurere]]\n[[metric drag item]]\n[[topic drag item]]\n[[topic details+*right+*structure]]\n[[metric details+*right+*structure]]\n[[style: rating]]\n[[script: rating]]\n[[*upvotes+*empty list]]\n[[*downvotes+*empty list]]"
      },
      {
        "name": "style rating",
        "type": "SCSS",
        "content": ".wiki {\r\n  float:left;\r\n  width: 50%;\r\n  .yinyang {\r\n    color: #ddd;\r\n    float: right;\r\n    font-size: 30px;\r\n  }\r\n}\r\n\r\n\r\n\r\n.rate{\r\n  float:left;\r\n  width: 50%;\r\n  background: #ddd;\r\n\r\n  .yinyang {\r\n    float: left;\r\n    color: #fff;\r\n    font-size: 30px;\r\n  }\r\n}\r\n\r\n\r\n.present-message {\r\n  display: none;\r\n}\r\n\r\n.empty-message {\r\n  padding: 15px;\r\n  border: 1px dashed #ccc;\r\n  text-align: center;\r\n}\r\n.list-drag-and-drop {\r\n  //border: 2px dashed #000;\r\n  margin: 10px;\r\n  padding: 5px;\r\n  background: #fff;\r\n  .list-group-item {\r\n    padding: 0;\r\n  }\r\n}\r\n\r\n.drag-item {\r\n  .header {\r\n    height: 100%;\r\n    float: left;\r\n    width: 70%;\r\n    border-right: 1px solid #ddd;\r\n  \r\n    .handle {\r\n      float: left;\r\n      margin-top: 20px;\r\n    }\r\n    .glyphicon-option-vertical.left {\r\n      margin-right: -4px;\r\n    }\r\n    .glyphicon-option-vertical.right {\r\n      margin-left: -4px;\r\n    }\r\n    button.vote-button {\r\n        width: 17px;\r\n        height: 17px;\r\n        padding: 0;\r\n        border: none;\r\n    }\r\n    .vote-count {\r\n        width: 20px;\r\n        height: 15px;\r\n    }\r\n    .title {\r\n      padding-top: 20px;\r\n      \r\n      .name {\r\n        padding-top: 15px;\r\n        padding-left: 10px;\r\n        font-size: 14px;\r\n      }\r\n    }\r\n  }\r\n  .data {\r\n    margin-top: 15px;\r\n    padding-left: 20px;\r\n    width: 30%;\r\n    height: 100%;\r\n    float: left;\r\n    height:100%;\r\n  }\r\n  \r\n  .details {\r\n    clear: both;\r\n  }\r\n  .details-toggle {\r\n    float: right;\r\n  }\r\n}\r\n\r\n.metric-item {\r\n  float:left; \r\n  //height: 60px;\r\n  width: 100%;\r\n  background:#fff;\r\n}\r\n\r\n\r\n\r\n.metric-year {\r\n  font-size: 14px;\r\n  color: gray;\r\n}\r\n.metric-value {\r\n  color: blue;\r\n  font-size: 18px;\r\n}\r\n\r\n\r\n.votee-filter {\r\n  background: #ccc;\r\n  padding: 5px;\r\n  text-align: center;\r\n}\r\n.filter-details {\r\n  display: none;\r\n}\r\n.filter-toggle {\r\n  float: right;\r\n}\r\n\r\n"
      },
      {
        "name": "script rating",
        "type": "CoffeeScript",
        "content": "handleDropEvent = ( event, ui ) ->\r\n  drag_item = ui.draggable\r\n  old_list = drag_item.parent()\r\n  if $(this).attr('data-bucket-name') != $(old_list).attr('data-bucket-name')    \r\n    # ui.draggable.position( { of: $(this), my: 'left top', at: 'left top' } );\r\n    drag_item.draggable( 'option', 'revert', false );\r\n    if old_list.find('.drag-item').length == 1\r\n      old_list.find('.empty-message').show()\r\n    if old_list.find('.drag-item').length == 2\r\n      old_list.find('.unsaved-message').hide()\r\n    $(this).append(drag_item)\r\n    drag_item.attr(\"style\",\"\")\r\n    $(this).find('.empty-message').hide()\r\n    $(this).find('.unsaved-message').show()\r\n\r\n    vote = drag_item.find('.vote-count') \r\n    update_path = drag_item.attr('data-update-path') + '&' + $(this).attr('data-query')\r\n    $(vote).closest('.card-slot').load(update_path)\r\n\r\n$('.list-drag-and-drop').droppable\r\n  accept: '.list-drag-and-drop div.drag-item',\r\n  drop: handleDropEvent\r\n\r\n  \r\n#$('.list-drag-and-drop').sortable()\r\n$('.drag-item').draggable\r\n  revert: true\r\n\r\n\r\n# vote buttons\r\n\r\ndrop_list = (votee, vote_type) ->\r\n  $(votee).closest('.voting').find(\".list-drag-and-drop[data-bucket-name=#{vote_type}]\")\r\n\r\n$('body').on 'click', '.list-drag-and-drop[data-bucket-name=no_vote] .drag-item .vote-up button.vote-link', ->\r\n  console.log \"no -> up\"\r\n  drag_up = $(this).closest('.drag-item')\r\n  $(drop_list(drag_up, 'up_vote')).append(drag_up)\r\n\r\n$('body').on 'click', '.list-drag-and-drop[data-bucket-name=down_vote] .drag-item .vote-up button.vote-link', ->\r\n  console.log \"down -> no\"\r\n  drag_up = $(this).closest('.drag-item')\r\n  $(drop_list(drag_up, 'no_vote')).append(drag_up)\r\n\r\n$('body').on 'click', '.list-drag-and-drop[data-bucket-name=up_vote] .drag-item .vote-down button.vote-link', ->\r\n  console.log \"up -> no\"\r\n  drag_down = $(this).closest('.drag-item')\r\n  $(drop_list(drag_down, 'no_vote')).prepend(drag_down)\r\n\r\n$('body').on 'click', '.list-drag-and-drop[data-bucket-name=no_vote] .drag-item .vote-down button.vote-link', ->\r\n  console.log \"no -> down\"\r\n  drag_down = $(this).closest('.drag-item')\r\n  $(drop_list(drag_down, 'down_vote')).prepend(drag_down)\r\n\r\n# filter\r\n\r\n$('body').on 'click','.filter-toggle', ->\r\n  parent = $(this).parent()\r\n  $(this).find('.glyphicon').toggleClass('glyphicon-triangle-bottom','glyphicon-triangle-right')\r\n  details = $(parent).find('.filter-details').toggle()\r\n  \r\n$('body').on 'click','.details-toggle', ->\r\n  item = $(this).closest('.drag-item')\r\n  $(this).find('.glyphicon').toggleClass('glyphicon-triangle-bottom','glyphicon-triangle-right')\r\n  card_name = $(item).attr('id')\r\n  details = $(item).find('.details')\r\n  if !$.trim(details.html()) # empty\r\n    view = $(this).attr('data-view') || 'content'\r\n    load_path = \"/#{card_name}+#{$(this).attr('data-append')}?view=#{view}\"\r\n    console.log(\"loal #{load_path}\")\r\n    $(details).load load_path\r\n  else if $(details).is(':visible')\r\n    $(details).hide()\r\n  else\r\n    $(details).show()\r\n  \r\n\r\n$('button.recent').on 'click', ->\r\n  console.log \"order by recent\"\r\n  $(this).closest('.voting').find('.list-drag-and-drop[data-bucket-name=no_vote] .drag-item').sortElements( (a, b) ->\r\n    if $(a).attr('data-sort-recent') > $(b).attr('data-sort-recent') \r\n      -1 \r\n    else\r\n      1\r\n  )\r\n\r\n$('button.importance').on 'click', ->\r\n  console.log \"order by importance\"\r\n  $(this).closest('.voting').find('.list-drag-and-drop[data-bucket-name=no_vote] .drag-item').sortElements( (a, b) ->\r\n    if $(a).attr('data-sort-importance') > $(b).attr('data-sort-importance') \r\n      -1\r\n    else\r\n      1\r\n  )\r\n\r\n\r\n###*\r\n# jQuery.fn.sortElements\r\n# --------------\r\n# @param Function comparator:\r\n#   Exactly the same behaviour as [1,2,3].sort(comparator)\r\n#   \r\n# @param Function getSortable\r\n#   A function that should return the element that is\r\n#   to be sorted. The comparator will run on the\r\n#   current collection, but you may want the actual\r\n#   resulting sort to occur on a parent or another\r\n#   associated element.\r\n#   \r\n#   E.g. $('td').sortElements(comparator, function(){\r\n#      return this.parentNode; \r\n#   })\r\n#   \r\n#   The <td>'s parent (<tr>) will be sorted instead\r\n#   of the <td> itself.\r\n###\r\n\r\njQuery.fn.sortElements = do ->\r\n  sort = [].sort\r\n  (comparator, getSortable) ->\r\n    getSortable = getSortable or ->\r\n      this\r\n    placements = @map(->\r\n      sortElement = getSortable.call(this)\r\n      parentNode = sortElement.parentNode\r\n      nextSibling = parentNode.insertBefore(document.createTextNode(''), sortElement.nextSibling)\r\n      ->\r\n        if parentNode == this\r\n          throw new Error('You can\\'t sort elements if any one is a descendant of another.')\r\n        # Insert before flag:\r\n        parentNode.insertBefore this, nextSibling\r\n        # Remove flag:\r\n        parentNode.removeChild nextSibling\r\n        return\r\n    )\r\n    sort.call(this, comparator).each (i) ->\r\n      placements[i].call getSortable.call(this)\r\n      return"
      },
      {
        "name": "latest value",
        "type": "Basic",
        "content": "",
        "codename": "latest_value"
      },
      {
        "name": "votee search",
        "type": "Basic",
        "content": "",
        "codename": "votee_search"
      },
      {
        "name": "non-votee search",
        "type": "Basic",
        "content": "",
        "codename": "non_votee_search"
      }
    ]
  }
}